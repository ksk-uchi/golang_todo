# 完了状態の表示・非表示切り替え機能の実装

## 背景

- `todos` テーブルには `done_at` というカラムがあるが、現在の実装ではまだ使っていない
- ユーザーは完了したタスクは基本的には非表示にしたい
  - 過去に完了したタスクを見返したいことはあるので完全に削除はしたくない

## 対応内容

1. (backend) `GET /todo` API が `?include_done` クエリパラメータを受け付けるように修正する
   - `include_done=false` の場合は `todos.done_at IS NULL` のレコードが出力対象となる
   - `include_done=true` の場合はレコード全件が出力対象となる
     - ただしページネーションのクエリパラメータと併用となるため、必ず全件出力するというわけではない
   - `include_done` クエリパラメータが指定されていない場合は `?include_done=false` と同じ結果を返却する
     - つまり `include_done` のデフォルト値は `false` である
   - `GET /todo` に対するテストとして `include_done=(true|false)` の場合のテストを追加する
2. (frontend) `frontend/src/app/page.tsx` の ToDo 一覧よりも少し上に「[x] 完了したものを非表示にする」のチェックボックスを配置する
   - チェックボックスは shadcn ui の `Checkbox` コンポーネントを使用する
     - `pnpm dlx shadcn@latest add checkbox` でインストールする
   - デフォルトでチェックありの状態とする
     - `GET /todo?include_done=false` で API を実行する
   - アプリケーションの URL `http://localhost:3000/` にはクエリパラメータは不要
     - チェックボックスの状態が変わったとしてもクエリパラメータは不要（ブラウザの戻るボタンの動作などは考慮しなくてもよい）
   - チェックの状態が変わったときに `GET /todo` API を再実行しページを再描画し直す
     - 何ページ目を開いていたとしても、このチェックの状態が変わった場合は 1 ページ目を表示する
     - チェックが付いた場合は `GET /todo?include_done=false` で API を実行する
     - チェックが外れた場合は `GET /todo?include_done=true` で API を実行する

## 作業ガイドライン

作業に当たり下記のガイドラインを必ず遵守してください

### backend, frontend 共通

- Implementation Plan, Task, Walkthrough やその他の情報交換は日本語で出力してください
- **対応内容の番号を振った段落ごとにコミットを作成すること**
- 明記されていないエッジケースがある場合、事前に確認を取ってください
  - 検討したうえで order ファイルに追記し、再度作業依頼をします
- 独自に実装するよりも近しい機能を持つ実装がインストール済みのライブラリに存在する場合は、事前に提案してください
  - 検討したうえで order ファイルに追記し、再度作業依頼をします
  - 例: ページネーションを実装してほしいと依頼されていますが MUI の Pagination コンポーネントを使うのはどうでしょうか？

### backend

- 対応後は全テストを実行しデグレードを見逃さないこと

### frontend

- `shadcn` コンポーネントを薄くラップするものは `src/app/components/ui/` 下に配置すること
- `src/app/components/ui` 下のコンポーネントを集めて機能を作るときは `src/app/components/` 下にファイルを作り実装すること
- `src/app/components` 下のコンポーネントを集めてページを作るときは `src/app/` 下にファイルを作り実装すること

## 許可済みコマンド

以下のコマンドは毎回確認を求めずに実行してよい (SafeToAutoRun: true)

- `git status`
- `git add .`
- `git commit -m "..."`
- `git log`
- `ls -R`
- `cat ...`
- `grep ...`
- `go test ...`
- `mise run ...`
